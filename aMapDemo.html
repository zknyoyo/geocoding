<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
  <title>鄞州银行信用卡数据分布</title>
  <link rel="stylesheet" href="http://cache.amap.com/lbs/static/main.css"/>
  <script src="http://webapi.amap.com/maps?v=1.3&key=0d6c853bb5cc1a7e87f9c3ce95dba0e1"></script>
  <script src="data.js"></script>
</head>

<body>
  <div id="mapContainer"></div>
  <div id="tip" class="button-group">
    <input type="button" class="button" value="自定义样式点聚合" id="add1" />
    <input type="button" class="button" value="默认样式点聚合" id="add0" />
  </div>
  <script>
    var cluster;
    var markers = [];

    // 地图初始化
    var map = new AMap.Map("mapContainer", {
      resizeEnable: true,
      center: [121.559555,29.866335],
      zoom: 12
    });

    // 随机向地图添加500个标注点
    var mapBounds = map.getBounds();
    var sw = mapBounds.getSouthWest();
    var ne = mapBounds.getNorthEast();
    var lngSpan = Math.abs(sw.lng - ne.lng);
    var latSpan = Math.abs(ne.lat - sw.lat);
//    var markerPositions = [[121.582902573,29.8533524209],[121.639577953,29.7897508094],[121.642529336,29.7942648492],[121.550907799,29.8856603997],[121.589783213,29.8262660089],[121.607196841,29.8094244038],[121.581256973,29.853255313],[121.56483455,29.8326418806],[121.465736185,29.8673296141],[121.451171091,29.8735200255],[121.581256973,29.853255313],[121.603383605,29.7279472382],[121.830142615,29.7300440524],[120.978873041,30.1091047918],[121.516967916,29.8348686592],[121.514441596,29.8320423583],[121.60609675,29.8105686541],[121.60609675,29.8105686541],[121.60609675,29.8105686541],[121.582902573,29.8533524209],[121.587524031,29.8581147072],[121.582096503,29.8565168401],[121.853268885,29.9125573968],[121.639577953,29.7897508094],[121.546183416,29.8301008677],[121.854228339,29.8925198841],[121.854228339,29.8925198841],[121.605184841,29.8543253128],[121.606784454,29.8538175569],[121.605184841,29.8543253128],[121.582902573,29.8533524209],[121.537834814,29.7854589333],[121.527740376,29.8542334622],[121.516967916,29.8348686592],[121.581256973,29.853255313],[121.581256973,29.853255313],[121.605184841,29.8543253128],[121.591213458,29.828278627],[121.692863968,29.9216591142],[121.606784454,29.8538175569],[121.605184841,29.8543253128],[121.581256973,29.853255313],[121.603189255,29.8547902314],[121.583025944,29.8673314],[121.364169562,29.7784283917],[121.598000852,29.8753924721],[121.544351214,29.8289756537],[121.583101347,29.8734604209],[121.559869191,29.8329054419],[121.544879621,29.7739272867],[121.496377388,29.7766389504],[121.60194565,29.73511274],[121.997016791,29.8839750727],[121.497034769,29.8294091124],[121.844033336,29.9123151243],[121.623213977,29.8913522194],[121.581256973,29.853255313],[121.582096503,29.8565168401],[121.84381257,29.9182390705],[121.851778514,29.9017423392],[121.573802786,29.8705841322],[121.459231328,29.8620707221],[121.602335837,29.728459102],[121.551919816,29.8494360568],[121.846091154,29.9226295137],[121.846091154,29.9226295137],[121.570218351,29.8416239769],[121.592690938,29.8647522914],[121.506328294,29.8373627587],[121.573802786,29.8705841322],[121.573802786,29.8705841322],[121.828469742,29.9051467819],[121.831341135,29.929171015],[121.64271851,29.8531286142],[121.921539162,29.8822828788],[121.512087422,29.835197229],[121.581256973,29.853255313],[121.904185111,29.4830564354],[121.582902573,29.8533524209],[121.577405609,29.8540911092],[121.58265943,29.8383279247],[121.507373656,29.7480020145],[121.608790834,29.7799397072],[121.581256973,29.853255313],[121.717194465,29.667031322],[121.516967916,29.8348686592],[121.405699098,29.8597396666],[121.833021697,29.9085905949],[121.570218351,29.8416239769],[121.595011351,29.8813389568],[121.855989404,29.8930079492],[121.566651151,29.8543198768],[121.847979896,29.916089114],[121.705764046,29.8502589636],[121.544257575,29.7743239833],[121.550126888,29.8860743721],[121.57681814,29.8216731837],[121.573802786,29.8705841322],[121.506658029,29.8376926627],[121.545232247,29.7786243107]];
    var markerPositions = bank_data;
    for (var i = 0; i < markerPositions.length; i++) {
      var markerPosition = markerPositions[i];
      var marker = new AMap.Marker({
        position: markerPosition,
        icon: "http://developer.amap.com/wp-content/uploads/2014/06/marker.png",
        offset: {
          x: -8,
          y: -34
        }
      });
      markers.push(marker);
    }
    addCluster(0);
    
    AMap.event.addDomListener(document.getElementById('add0'),'click', function() {
      addCluster(0);
    });
    
    AMap.event.addDomListener(document.getElementById('add1'),'click', function() {
      addCluster(1);
    });

    // 添加点聚合
    function addCluster(tag) {
      if (cluster) {
        cluster.setMap(null);
      }
      if (tag == 1) {
        var sts = [{
          url: "http://developer.amap.com/wp-content/uploads/2014/06/1.png",
          size: new AMap.Size(32, 32),
          offset: new AMap.Pixel(-16, -30)
        }, {
          url: "http://developer.amap.com/wp-content/uploads/2014/06/2.png",
          size: new AMap.Size(32, 32),
          offset: new AMap.Pixel(-16, -30)
        }, {
          url: "http://developer.amap.com/wp-content/uploads/2014/06/3.png",
          size: new AMap.Size(48, 48),
          offset: new AMap.Pixel(-24, -45),
          textColor: '#CC0066'
        }];
        map.plugin(["AMap.MarkerClusterer"], function () {
          cluster = new AMap.MarkerClusterer(map, markers, {
            styles: sts
          });
        });
      } else {
        map.plugin(["AMap.MarkerClusterer"], function () {
          cluster = new AMap.MarkerClusterer(map, markers);
        });
      }
    }
  </script>
</body>

</html>